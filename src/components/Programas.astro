---
import programas from "@/data/programas.json";
const programasJSON = JSON.stringify(programas);
---
<section
  id="programas"
  class="relative py-20 bg-[var(--color-dark)] text-[var(--color-light)] overflow-hidden"
>
  <!-- üå´Ô∏è Degradado superior -->
  <div class="absolute top-0 inset-x-0 h-24 bg-gradient-to-b from-black/40 to-transparent"></div>

  <!-- üè∑Ô∏è T√çTULO -->
  <div class="text-center mb-16 relative z-10">
    <h2 class="text-4xl md:text-5xl font-extrabold tracking-wide mb-4">
      NUESTROS <span class="text-[var(--color-secondary)]">PROGRAMAS</span>
    </h2>
    <div class="flex justify-center mt-4 mb-8">
      <div class="w-32 h-[3px] bg-[var(--color-accent)] rounded-full shadow-[0_0_15px_rgba(255,215,0,0.6)]"></div>
    </div>
    <p class="text-light/80 max-w-2xl mx-auto text-lg font-light">
      Entrenamientos adaptados a cada etapa del desarrollo futbol√≠stico: t√©cnica, disciplina y valores.
    </p>
  </div>

  <!-- üü© GRID DE PROGRAMAS -->
  <div class="max-w-6xl mx-auto grid gap-10 md:grid-cols-3 px-6 relative z-10">
    <!-- üë¶ INFANTIL -->
    <div
      class="group relative bg-gradient-to-b from-[var(--color-primary)]/90 to-[var(--color-secondary)]/80 rounded-xl shadow-lg overflow-hidden hover:scale-[1.03] transition-transform duration-500"
    >
      <img
        src="img/programa-infantil.webp"
        loading="lazy"
        alt="Programa Infantil"
        class="w-full h-56 object-cover opacity-80 group-hover:opacity-100 transition duration-300"
      />
      <div class="p-6">
        <h3 class="text-2xl font-bold mb-2">Categor√≠a Infantil</h3>
        <p class="text-light/80 text-sm mb-4">
          Enfoque en coordinaci√≥n, diversi√≥n y fundamentos del juego. Desarrollamos pasi√≥n y disciplina desde peque√±os.
        </p>
        <button
          data-programa="infantil"
          class="inline-block mt-2 bg-[var(--color-accent)] text-[var(--color-dark)] font-semibold px-4 py-2 rounded-md shadow-md hover:bg-yellow-400 hover:scale-105 transition-all duration-300"
        >
          Ver m√°s
        </button>
      </div>
    </div>

    <!-- üßí JUVENIL -->
    <div
      class="group relative bg-gradient-to-b from-[var(--color-primary)]/90 to-[var(--color-secondary)]/80 rounded-xl shadow-lg overflow-hidden hover:scale-[1.03] transition-transform duration-500"
    >
      <img
        src={"img/programa-juvenil.webp"}
        loading="lazy"
        alt="Programa Juvenil"
        class="w-full h-56 object-cover opacity-80 group-hover:opacity-100 transition duration-300"
      />
      <div class="p-6">
        <h3 class="text-2xl font-bold mb-2">Categor√≠a Juvenil</h3>
        <p class="text-light/80 text-sm mb-4">
          Potenciamos la t√©cnica, la estrategia y la disciplina mental. Fomentamos el liderazgo y la cooperaci√≥n.
        </p>
        <button
          data-programa="juvenil"
          class="inline-block mt-2 bg-[var(--color-accent)] text-[var(--color-dark)] font-semibold px-4 py-2 rounded-md shadow-md hover:bg-yellow-400 hover:scale-105 transition-all duration-300"
        >
          Ver m√°s
        </button>
      </div>
    </div>

    <!-- ü¶å AVANZADO -->
    <div
      class="group relative bg-gradient-to-b from-[var(--color-primary)]/90 to-[var(--color-secondary)]/80 rounded-xl shadow-lg overflow-hidden hover:scale-[1.03] transition-transform duration-500"
    >
      <img
        src={"img/programa-avanzado.webp"}
        loading="lazy"
        alt="Programa Avanzado"
        class="w-full h-56 object-cover opacity-80 group-hover:opacity-100 transition duration-300"
      />
      <div class="p-6">
        <h3 class="text-2xl font-bold mb-2">Categor√≠a Avanzada</h3>
        <p class="text-light/80 text-sm mb-4">
          Entrenamiento competitivo de alto rendimiento. Preparaci√≥n t√©cnica y t√°ctica para niveles profesionales.
        </p>
        <button
          data-programa="avanzado"
          class="inline-block mt-2 bg-[var(--color-accent)] text-[var(--color-dark)] font-semibold px-4 py-2 rounded-md shadow-md hover:bg-yellow-400 hover:scale-105 transition-all duration-300"
        >
          Ver m√°s
        </button>
      </div>
    </div>
  </div>

  <!-- üü© MODAL DETALLE OPTIMIZADO -->
<div
  id="modal-programa"
  class="fixed inset-0 bg-black/80 backdrop-blur-md hidden items-center justify-center z-50"
>
  <div
    id="modal-content"
    class="relative bg-[var(--color-dark)] rounded-2xl border border-[var(--color-secondary)]/40 shadow-[0_0_40px_rgba(0,0,0,0.6)] max-w-6xl w-[95%] overflow-hidden opacity-0 scale-95 transition-all duration-400 ease-out"
  >
    <!-- ‚ùå Bot√≥n de cierre -->
    <button
      id="closeModal"
      class="absolute top-4 right-5 text-light/70 hover:text-[var(--color-accent)] text-2xl font-bold transition z-20"
      aria-label="Cerrar"
    >
      √ó
    </button>

    <!-- üìò Contenido -->
    <div class="p-8 md:p-10 text-left">
      <!-- üè∑Ô∏è T√≠tulo -->
      <h3
        id="modal-title"
        class="text-3xl md:text-4xl font-extrabold text-[var(--color-accent)] mb-3 tracking-tight"
      >
        T√≠tulo del Programa
      </h3>

      <!-- Descripci√≥n principal -->
      <p
        id="modal-desc"
        class="text-light/90 text-[1.05rem] leading-relaxed mb-8 max-w-3xl"
      >
        Descripci√≥n extendida del programa...
      </p>

      <!-- üß© Bloques en 3 columnas -->
      <div class="grid md:grid-cols-3 gap-8 mb-10">
        <!-- Beneficios -->
        <div>
          <h4 class="text-lg font-semibold mb-3 text-[var(--color-secondary)]">
            Beneficios
          </h4>
          <ul
            id="modal-beneficios"
            class="grid gap-y-2 text-light/85 text-sm leading-snug"
          ></ul>
        </div>

        <!-- Valores -->
        <div>
          <h4 class="text-lg font-semibold mb-3 text-[var(--color-secondary)]">
            Valores
          </h4>
          <div
            id="modal-valores"
            class="flex flex-wrap gap-2 text-[var(--color-accent)] text-sm font-semibold"
          ></div>
        </div>

        <!-- Horarios -->
        <div>
          <h4 class="text-lg font-semibold mb-3 text-[var(--color-secondary)]">
            Horarios y Niveles
          </h4>
          <div
            id="modal-extra"
            class="bg-[var(--color-primary)]/60 rounded-lg p-5 border border-[var(--color-secondary)]/30 text-sm text-light/85"
          ></div>
        </div>
      </div>

      <!-- üì∏ Galer√≠a tipo slider -->
      <div class="relative mb-10">
        <h4 class="text-lg font-semibold mb-3 text-[var(--color-secondary)]">
          Momentos del Entrenamiento
        </h4>

        <div class="relative overflow-hidden">
          <!-- Slider -->
          <div
            id="modal-slider"
            class="flex gap-3 overflow-x-auto snap-x snap-mandatory scroll-smooth no-scrollbar"
          ></div>

          <!-- Controles -->
          <button
            id="prev-slide"
            aria-label="Anterior"
            class="absolute left-0 top-1/2 -translate-y-1/2 bg-[var(--color-primary)]/70 text-[var(--color-accent)] hover:bg-[var(--color-primary)] transition rounded-full w-8 h-8 flex items-center justify-center shadow-lg"
          >
            ‚Äπ
          </button>
          <button
            id="next-slide"
            aria-label="Siguiente"
            class="absolute right-0 top-1/2 -translate-y-1/2 bg-[var(--color-primary)]/70 text-[var(--color-accent)] hover:bg-[var(--color-primary)] transition rounded-full w-8 h-8 flex items-center justify-center shadow-lg"
          >
            ‚Ä∫
          </button>
        </div>
      </div>

      <!-- CTA -->
      <div class="text-center">
        <a
          href="#inscripcion"
          class="inline-block bg-[var(--color-accent)] text-[var(--color-dark)] font-semibold px-8 py-3 rounded-md shadow-md hover:scale-105 transition"
        >
          Inscribirme ahora
        </a>
      </div>
    </div>
  </div>
</section>

<!-- ‚úÖ JSON embebido literalmente -->
<script type="application/json" id="programas-data" set:html={programasJSON}></script>

<!-- ‚ú® SCRIPT OPTIMIZADO -->
<script is:inline>
  
  const dataTag = document.getElementById("programas-data");
  let programas = {};

  try {
    programas = JSON.parse(dataTag.textContent.trim());
    console.log("‚úÖ Programas cargados correctamente:", programas);
  } catch (err) {
    console.error("‚ùå Error al parsear los programas:", err, dataTag.textContent);
  }

  // ===============================
  // ‚öôÔ∏è L√≥gica del modal
  // ===============================
  const modal = document.getElementById("modal-programa");
  const content = document.getElementById("modal-content");
  const closeModal = document.getElementById("closeModal");
  const slider = document.getElementById("modal-slider");

  document.querySelectorAll("[data-programa]").forEach((btn) => {
    btn.addEventListener(
      "click",
      (e) => {
        e.preventDefault();
        const id = btn.dataset.programa;
        const p = programas[id];
        if (!p) return console.warn(`‚ö†Ô∏è Programa '${id}' no encontrado`);

        // Contenido
        document.getElementById("modal-title").textContent = p.titulo;
        document.getElementById("modal-desc").textContent = p.desc;
        document.getElementById("modal-beneficios").innerHTML = p.beneficios
          .map((b) => `<li>${b}</li>`)
          .join("");
        document.getElementById("modal-valores").innerHTML = p.valores
          .map(
            (v) =>
              `<span class="bg-[var(--color-secondary)]/20 px-3 py-1 rounded-full border border-[var(--color-secondary)]/40">${v}</span>`
          )
          .join("");
        document.getElementById("modal-extra").innerHTML = p.extra;
        slider.innerHTML = p.galeria
          .map(
            (g) =>
              `<img src="${g}" loading="lazy" decoding="async" class="rounded-md w-64 h-40 object-cover snap-center shrink-0 hover:scale-105 transition-all" />`
          )
          .join("");

        // Mostrar modal sin scroll en p√°gina
        document.documentElement.classList.add("overflow-hidden");
        modal.classList.remove("hidden");
        modal.classList.add("flex");
        requestAnimationFrame(() => {
          content.classList.remove("opacity-0", "scale-95");
          content.classList.add("opacity-100", "scale-100");
        });
      },
      { passive: true }
    );
  });

  // Cierre modal
  closeModal.addEventListener("click", () => {
    content.classList.add("opacity-0", "scale-95");
    document.documentElement.classList.remove("overflow-hidden");
    setTimeout(() => {
      modal.classList.add("hidden");
      modal.classList.remove("flex");
    }, 400);
  });
  modal.addEventListener("click", (e) => {
    if (e.target === modal) closeModal.click();
  });

  // ===============================
  // üéûÔ∏è Slider simple (sin repaints)
  // ===============================
  document.getElementById("prev-slide").addEventListener("click", () => {
    slider.scrollBy({ left: -300, behavior: "smooth" });
  });
  document.getElementById("next-slide").addEventListener("click", () => {
    slider.scrollBy({ left: 300, behavior: "smooth" });
  });
</script>
